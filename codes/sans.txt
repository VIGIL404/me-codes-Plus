client.on("message", async message => { let prefix = "#"; let args = message.content.split(/[ ]+/); let text = args.slice(1).join(" "); const url = "https://demirramon.com/gen/undertale_text_box.png"; if (message.content.startsWith(prefix + "sans")) { if (!text) { return message.channel.send(`No message provided.`); } message.channel.startTyping(); let params = "box=undertale&boxcolor=white&character=undertale-sans&expression=default&charcolor=white&font=determination&asterisk=true&mode=regular&text=" + encodeURIComponent(text); try { message.channel.stopTyping(); message.channel.send({ files: [new Discord.Attachment(url + "?" + params, "undertale.png")] }); } catch (err) { message.channel.stopTyping(); message.channel.send(`Error when generating image: \`${err}\``); } } }); 